"use strict";

var CommonService = require("../dbservices/Common");
var logUtil = require("../lib/logUtil");

var commonService = new CommonService();

var loadFromFile = function(fn) {
  var data = require(fn);
  console.log("data.length = " + data.length);
  for (let i in data) {
    let tmp = data[i].default || data[i];
    console.log(tmp.id);

    commonService.upsert(tmp, (err, res) => {
      if (err) {
        logUtil.error(err);
      } else {
        logUtil.info("Done 1");
      }

    });
  }
};

//------------------------------------------------------------
loadFromFile("./danhMuc/tinh.json");
loadFromFile("./danhMuc/huyen.json");
//loadFromFile("./danhMuc/xa_hn_hcm.json");
loadFromFile("./danhMuc/xa1.json");
loadFromFile("./danhMuc/xa2.json");
loadFromFile("./danhMuc/duan.json");

var times = 0;
var timer = setInterval(
    () => {
      commonService.countByType("Place", (cnt) => {
            console.log("Cnt = " + cnt);
        });
        times ++;
        console.log(times + ", " + timer);
        if (times > 2) {
            console.log("Clear...");
            clearInterval(timer);
        }
    }, 1000);

